<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒŸ Ù…ØªØ¬Ø± Ø´Ø§Ù…Ù„</title>
    <style>
        body {
            font-family: 'Tahoma', sans-serif;
            margin: 0;
            padding: 0;
            background: #f9f9f9;
        }
        
        header {
            background: #007bff;
            color: #fff;
            padding: 10px;
            text-align: center;
            font-size: 18px;
        }
        
        nav {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
        }
        
        nav button {
            flex: 1;
            border: none;
            background: none;
            padding: 8px;
            font-size: 15px;
            cursor: pointer;
        }
        
        nav button.active {
            background: #007bff;
            color: #fff;
        }
        
        section {
            display: none;
            padding: 10px;
        }
        
        section.active {
            display: block;
        }
        
        #store .section-title {
            font-size: 17px;
            margin: 5px 0;
            color: #007bff;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        
        .card {
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #fff;
            padding: 6px;
            text-align: center;
        }
        
        .card img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 4px;
        }
        
        select, input {
            margin-top: 4px;
            width: 95%;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        button.addBtn, button.buyBtn, button.small {
            background: #28a745;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 4px 6px;
            cursor: pointer;
            margin-top: 4px;
        }
        
        button.addBtn:hover, button.buyBtn:hover, button.small:hover {
            background: #218838;
        }
        
        h3, h4 {
            margin-top: 0;
        }
        
        footer {
            text-align: center;
            padding: 6px;
            font-size: 12px;
            color: #777;
            border-top: 1px solid #ddd;
            margin-top: 10px;
        }
        
        #adminPanel {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px;
            margin-top: 8px;
        }
        
        ul {
            list-style: none;
            padding: 0;
        }
        
        li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
    <header>ğŸŒŸ Ù…ØªØ¬Ø± Ø´Ø§Ù…Ù„</header>
    <nav>
        <button id="tabStore" class="active">ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</button>
        <button id="tabCart">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</button>
        <button id="tabAccount">ğŸ‘¤ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
        <button id="tabAdmin" style="display:none;">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    </nav>
    
    <section id="store" class="active">
        <div id="categories"></div>
    </section>
    
    <section id="cart">
        <h3>ğŸ›’ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ù„Ø©</h3>
        <ul id="cartList"></ul>
        <button id="checkoutBtn" class="buyBtn">ğŸ’° Ø´Ø±Ø§Ø¡ Ø§Ù„Ø³Ù„Ø©</button>
        <h4>ğŸ“œ Ù…Ø´ØªØ±ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©</h4>
        <ul id="ordersList"></ul>
    </section>
    
    <section id="account">
        <div id="loginForm">
            <h3>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <input type="text" id="loginPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button id="loginBtn">âœ”ï¸ Ø¯Ø®ÙˆÙ„</button>
            <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <button id="showRegisterBtn" class="small">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button></p>
        </div>
        <div id="registerForm" style="display:none;">
            <h3>ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
            <input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
            <input type="text" id="regPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            <input type="password" id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button id="registerBtn">âœ”ï¸ ØªØ³Ø¬ÙŠÙ„</button>
            <p>Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <button id="showLoginBtn" class="small">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button></p>
        </div>
        <div id="profileInfo" style="display:none;">
            <div>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: <span id="accName"></span></div>
            <div>ğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: <span id="accPhone"></span></div>
            <div>ğŸ†” Ø§Ù„ÙƒÙˆØ¯: <span id="accCode"></span></div>
            <div>â­ Ù†Ù‚Ø§Ø·ÙŠ: <span id="accPoints"></span></div>
            <button id="changePassBtn" class="small">ğŸ”’ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</button>
            <div id="passChange" style="display:none;">
                <input type="password" id="newPass" placeholder="ÙƒÙ„Ù…Ø© Ø³Ø± Ø¬Ø¯ÙŠØ¯Ø©">
                <button id="savePassBtn" class="small">âœ”ï¸ Ø­ÙØ¸</button>
            </div>
            <button id="deleteAccountBtn" class="small">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨</button>
            <button id="logoutBtn" class="small">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </section>
    
    <section id="admin">
        <h3>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <div id="adminPanel"></div>
    </section>
    
    <footer>ğŸ’ Powered by Almasa ğŸ’</footer>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const products = [
            {
                category: "ğŸ¥¦ Ø®Ø¶Ø±ÙˆØ§Øª",
                items: Array.from({length: 5}, (_, i) => ({
                    id: `veg-${i+1}`,
                    name: `Ø®Ø¶Ø§Ø± ${i+1}`,
                    price: 5 + i,
                    image: `https://via.placeholder.com/150?text=Veg${i+1}`
                }))
            },
            {
                category: "ğŸ ÙÙˆØ§ÙƒÙ‡",
                items: Array.from({length: 5}, (_, i) => ({
                    id: `fruit-${i+1}`,
                    name: `ÙØ§ÙƒÙ‡Ø© ${i+1}`,
                    price: 6 + i,
                    image: `https://via.placeholder.com/150?text=Fruit${i+1}`
                }))
            }
        ];

        // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let state = {
            cart: [],
            orders: [],
            users: [],
            admins: [{phone: "admin", pass: "admin123", role: "super"}],
            loggedUser: null
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const elements = {
            tabs: {
                store: document.getElementById('store'),
                cart: document.getElementById('cart'),
                account: document.getElementById('account'),
                admin: document.getElementById('admin')
            },
            tabButtons: {
                store: document.getElementById('tabStore'),
                cart: document.getElementById('tabCart'),
                account: document.getElementById('tabAccount'),
                admin: document.getElementById('tabAdmin')
            },
            auth: {
                loginForm: document.getElementById('loginForm'),
                registerForm: document.getElementById('registerForm'),
                profileInfo: document.getElementById('profileInfo'),
                loginBtn: document.getElementById('loginBtn'),
                registerBtn: document.getElementById('registerBtn'),
                showRegisterBtn: document.getElementById('showRegisterBtn'),
                showLoginBtn: document.getElementById('showLoginBtn'),
                logoutBtn: document.getElementById('logoutBtn')
            }
        };

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function init() {
            loadData();
            setupEventListeners();
            renderStore();
            updateUI();
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        function loadData() {
            const savedData = localStorage.getItem('storeData');
            if (savedData) {
                state = JSON.parse(savedData);
            }
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function saveData() {
            localStorage.setItem('storeData', JSON.stringify(state));
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function setupEventListeners() {
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            elements.tabButtons.store.addEventListener('click', () => switchTab('store'));
            elements.tabButtons.cart.addEventListener('click', () => switchTab('cart'));
            elements.tabButtons.account.addEventListener('click', () => switchTab('account'));
            elements.tabButtons.admin.addEventListener('click', () => switchTab('admin'));
            
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø­Ø³Ø§Ø¨
            elements.auth.loginBtn.addEventListener('click', login);
            elements.auth.registerBtn.addEventListener('click', register);
            elements.auth.showRegisterBtn.addEventListener('click', showRegisterForm);
            elements.auth.showLoginBtn.addEventListener('click', showLoginForm);
            elements.auth.logoutBtn.addEventListener('click', logout);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø£Ø®Ø±Ù‰
            document.getElementById('checkoutBtn').addEventListener('click', checkout);
            document.getElementById('changePassBtn').addEventListener('click', showChangePassword);
            document.getElementById('savePassBtn').addEventListener('click', changePassword);
            document.getElementById('deleteAccountBtn').addEventListener('click', deleteAccount);
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            Object.values(elements.tabs).forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø´ÙŠØ· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            Object.values(elements.tabButtons).forEach(button => {
                button.classList.remove('active');
            });
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙˆØªÙ†Ø´ÙŠØ· Ø§Ù„Ø²Ø±
            elements.tabs[tabName].classList.add('active');
            elements.tabButtons[tabName].classList.add('active');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©
            if (tabName === 'store') renderStore();
            else if (tabName === 'cart') renderCart();
            else if (tabName === 'account') renderAccount();
            else if (tabName === 'admin') renderAdmin();
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¬Ø±
        function renderStore() {
            let html = '';
            
            products.forEach(category => {
                html += `<div class="section-title">${category.category}</div><div class="grid">`;
                
                category.items.forEach(item => {
                    html += `
                        <div class="card">
                            <img src="${item.image}" alt="${item.name}">
                            <div>${item.name}</div>
                            <div>${item.price} Ø¬Ù†ÙŠÙ‡</div>
                            <select id="qty-${item.id}">
                                <option value="">Ø§Ø®ØªØ±</option>
                                ${Array.from({length: 5}, (_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
                            </select>
                            <button class="addBtn" data-id="${item.id}">â• Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
                        </div>
                    `;
                });
                
                html += '</div>';
            });
            
            document.getElementById('categories').innerHTML = html;
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
            document.querySelectorAll('.addBtn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const qtySelect = document.getElementById(`qty-${productId}`);
                    const qty = parseInt(qtySelect.value);
                    
                    if (!qty) {
                        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ÙƒÙ…ÙŠØ©');
                        return;
                    }
                    
                    addToCart(productId, qty);
                    qtySelect.value = '';
                });
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©
        function addToCart(productId, quantity) {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬
            let product = null;
            for (const category of products) {
                product = category.items.find(item => item.id === productId);
                if (product) break;
            }
            
            if (!product) return;
            
            // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
            const existingItem = state.cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                state.cart.push({
                    id: productId,
                    name: product.name,
                    price: product.price,
                    quantity: quantity,
                    image: product.image
                });
            }
            
            saveData();
            alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${quantity} Ù…Ù† ${product.name} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`);
            updateCartBadge();
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©
        function renderCart() {
            const cartList = document.getElementById('cartList');
            const emptyCart = document.getElementById('emptyCart');
            
            if (state.cart.length === 0) {
                cartList.innerHTML = '<li>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</li>';
                document.getElementById('checkoutBtn').style.display = 'none';
                return;
            }
            
            let html = '';
            let total = 0;
            
            state.cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                html += `
                    <li>
                        ${item.name} - ${item.quantity} Ã— ${item.price} = ${itemTotal} Ø¬Ù†ÙŠÙ‡
                        <button onclick="removeFromCart(${index})" class="small">âŒ Ø­Ø°Ù</button>
                    </li>
                `;
            });
            
            cartList.innerHTML = html;
            document.getElementById('checkoutBtn').style.display = 'block';
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            renderOrders();
        }

        // Ø­Ø°Ù Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©
        function removeFromCart(index) {
            state.cart.splice(index, 1);
            saveData();
            renderCart();
            updateCartBadge();
        }

        // Ø§ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡
        function checkout() {
            if (state.cart.length === 0) return;
            
            const order = {
                items: [...state.cart],
                date: new Date().toLocaleString(),
                total: state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            };
            
            state.orders.push(order);
            state.cart = [];
            saveData();
            
            alert(`ØªÙ… Ø§ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${order.total} Ø¬Ù†ÙŠÙ‡`);
            renderCart();
            updateCartBadge();
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
        function renderOrders() {
            const ordersList = document.getElementById('ordersList');
            
            if (state.orders.length === 0) {
                ordersList.innerHTML = '<li>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´ØªØ±ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©</li>';
                return;
            }
            
            let html = '';
            
            state.orders.forEach((order, index) => {
                html += `
                    <li>
                        Ø¹Ù…Ù„ÙŠØ© #${index + 1} - ${order.date}
                        <div>${order.items.length} ØµÙ†Ù - ${order.total} Ø¬Ù†ÙŠÙ‡</div>
                    </li>
                `;
            });
            
            ordersList.innerHTML = html;
        }

        // Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø­Ø³Ø§Ø¨
        function renderAccount() {
            if (state.loggedUser) {
                elements.auth.loginForm.style.display = 'none';
                elements.auth.registerForm.style.display = 'none';
                elements.auth.profileInfo.style.display = 'block';
                
                document.getElementById('accName').textContent = state.loggedUser.name || '-';
                document.getElementById('accPhone').textContent = state.loggedUser.phone;
                document.getElementById('accCode').textContent = state.loggedUser.code || '-';
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· (5% Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª)
                const totalSpent = state.orders.reduce((sum, order) => sum + order.total, 0);
                const points = Math.floor(totalSpent * 0.05);
                document.getElementById('accPoints').textContent = points;
            } else {
                elements.auth.loginForm.style.display = 'block';
                elements.auth.registerForm.style.display = 'none';
                elements.auth.profileInfo.style.display = 'none';
            }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function login() {
            const phone = document.getElementById('loginPhone').value.trim();
            const password = document.getElementById('loginPass').value.trim();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±
            const admin = state.admins.find(a => a.phone === phone && a.pass === password);
            if (admin) {
                state.loggedUser = {
                    phone: admin.phone,
                    role: admin.role
                };
                elements.tabButtons.admin.style.display = 'inline';
                switchTab('admin');
                saveData();
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const user = state.users.find(u => u.phone === phone && u.pass === password);
            if (user) {
                state.loggedUser = user;
                elements.tabButtons.admin.style.display = 'none';
                switchTab('store');
                saveData();
            } else {
                alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
            
            updateUI();
        }

        // Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        function showRegisterForm() {
            elements.auth.loginForm.style.display = 'none';
            elements.auth.registerForm.style.display = 'block';
        }

        // Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function showLoginForm() {
            elements.auth.registerForm.style.display = 'none';
            elements.auth.loginForm.style.display = 'block';
        }

        // ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
        function register() {
            const name = document.getElementById('regName').value.trim();
            const phone = document.getElementById('regPhone').value.trim();
            const password = document.getElementById('regPass').value.trim();
            
            if (!name || !phone || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                return;
            }
            
            if (state.users.some(u => u.phone === phone)) {
                alert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„');
                return;
            }
            
            const newUser = {
                name,
                phone,
                pass: password,
                code: Math.floor(1000 + Math.random() * 9000).toString()
            };
            
            state.users.push(newUser);
            state.loggedUser = newUser;
            saveData();
            
            alert(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø¶Ùˆ: ${newUser.code}`);
            updateUI();
            switchTab('store');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            state.loggedUser = null;
            saveData();
            updateUI();
            switchTab('account');
        }

        // Ø¹Ø±Ø¶ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
        function showChangePassword() {
            document.getElementById('passChange').style.display = 'block';
        }

        // ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
        function changePassword() {
            const newPass = document.getElementById('newPass').value.trim();
            
            if (newPass.length < 4) {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                return;
            }
            
            state.loggedUser.pass = newPass;
            state.users = state.users.map(u => 
                u.phone === state.loggedUser.phone ? state.loggedUser : u
            );
            
            saveData();
            document.getElementById('passChange').style.display = 'none';
            document.getElementById('newPass').value = '';
            alert('ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø¨Ù†Ø¬Ø§Ø­');
        }

        // Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨
        function deleteAccount() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡')) {
                return;
            }
            
            state.users = state.users.filter(u => u.phone !== state.loggedUser.phone);
            state.loggedUser = null;
            saveData();
            
            alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
            updateUI();
            switchTab('account');
        }

        // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        function renderAdmin() {
            if (!state.loggedUser?.role) {
                switchTab('account');
                return;
            }
            
            let html = `
                <h4>Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡</h4>
                <ul>
                    ${state.admins.map(admin => `
                        <li>
                            ${admin.phone} (${admin.role === 'super' ? 'Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…' : 'Ù…Ø¯ÙŠØ±'})
                            ${admin.phone !== state.loggedUser.phone ? 
                                `<button onclick="removeAdmin('${admin.phone}')" class="small">Ø­Ø°Ù</button>` : ''}
                        </li>
                    `).join('')}
                </ul>
                
                <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ø¯ÙŠØ± Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="newAdminPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                <input type="password" id="newAdminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
                <select id="newAdminRole">
                    <option value="admin">Ù…Ø¯ÙŠØ±</option>
                    <option value="super">Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…</option>
                </select>
                <button onclick="addAdmin()" class="addBtn">Ø¥Ø¶Ø§ÙØ©</button>
            `;
            
            document.getElementById('adminPanel').innerHTML = html;
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¯ÙŠØ± Ø¬Ø¯ÙŠØ¯
        function addAdmin() {
            const phone = document.getElementById('newAdminPhone').value.trim();
            const password = document.getElementById('newAdminPass').value.trim();
            const role = document.getElementById('newAdminRole').value;
            
            if (!phone || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                return;
            }
            
            if (state.admins.some(a => a.phone === phone)) {
                alert('Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¯ÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„');
                return;
            }
            
            state.admins.push({ phone, pass: password, role });
            saveData();
            renderAdmin();
            alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­');
        }

        // Ø­Ø°Ù Ù…Ø¯ÙŠØ±
        function removeAdmin(phone) {
            if (phone === state.loggedUser.phone) {
                alert('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù†ÙØ³Ùƒ');
                return;
            }
            
            state.admins = state.admins.filter(a => a.phone !== phone);
            saveData();
            renderAdmin();
            alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­');
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUI() {
            renderAccount();
            updateCartBadge();
            
            if (state.loggedUser?.role) {
                elements.tabButtons.admin.style.display = 'inline';
            } else {
                elements.tabButtons.admin.style.display = 'none';
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¨Ø§Ø¯Ø¬ Ø§Ù„Ø³Ù„Ø©
        function updateCartBadge() {
            const badge = document.getElementById('cartBadge');
            if (state.cart.length > 0) {
                badge.textContent = state.cart.length;
                badge.style.display = 'inline';
            } else {
                badge.style.display = 'none';
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.onload = init;

        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ù„Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ù† HTML
        window.removeFromCart = removeFromCart;
        window.removeAdmin = removeAdmin;
        window.addAdmin = addAdmin;
    </script>
</body>
</html>
